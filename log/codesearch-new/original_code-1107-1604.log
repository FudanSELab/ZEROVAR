[INFO] 2022-11-07 16:04:53,468 - Setting: ['original_code']
[INFO] 2022-11-07 16:04:53,468 - Config: 
{
    "encoder_epoches": 4,
    "classifier_epoches": 3,
    "data_path": "data/database/codesearch-new",
    "saved_path": "data/codesearchmodel",
    "train_batch_size": 8,
    "eval_batch_size": 16,
    "use_cuda": true,
    "max_nl_len": 32,
    "max_pl_len": 480,
    "filter_K": 100,
    "final_K": 15,
    "test_path": "data/database/codesearch-new/origin_data/java_test_1.jsonl",
    "run_way": "test",
    "confidence": 0.5
}
[INFO] 2022-11-07 16:04:53,468 - Loading train dataset...
[INFO] 2022-11-07 16:05:06,224 - Loading eval dataset...
[INFO] 2022-11-07 16:05:06,430 - Loading test dataset...
[INFO] 2022-11-07 16:05:08,251 - Loading encoder...
[INFO] 2022-11-07 16:05:10,172 - Start training...
[INFO] 2022-11-07 16:05:11,478 - Total step: 139188
[INFO] 2022-11-07 16:06:49,434 - Epoch:1, Batch:500, Average Loss:0.6691772047877311, Current Loss:0.33901363611221313
[INFO] 2022-11-07 16:08:28,532 - Epoch:1, Batch:1000, Average Loss:0.5079523054137826, Current Loss:0.25620466470718384
[INFO] 2022-11-07 16:10:05,950 - Epoch:1, Batch:1500, Average Loss:0.4372000817159812, Current Loss:0.45993149280548096
[INFO] 2022-11-07 16:11:43,505 - Epoch:1, Batch:2000, Average Loss:0.3990659977272153, Current Loss:0.2932477593421936
[INFO] 2022-11-07 16:13:23,105 - Epoch:1, Batch:2500, Average Loss:0.37246535570919515, Current Loss:0.06228002905845642
[INFO] 2022-11-07 16:15:02,098 - Epoch:1, Batch:3000, Average Loss:0.3544047095204393, Current Loss:0.07863948494195938
[INFO] 2022-11-07 16:16:39,952 - Epoch:1, Batch:3500, Average Loss:0.3412622789570263, Current Loss:0.18087562918663025
[INFO] 2022-11-07 16:18:18,063 - Epoch:1, Batch:4000, Average Loss:0.3295606771968305, Current Loss:0.32113227248191833
[INFO] 2022-11-07 16:19:56,332 - Epoch:1, Batch:4500, Average Loss:0.31986606014437147, Current Loss:0.1839015781879425
[INFO] 2022-11-07 16:21:33,796 - Epoch:1, Batch:5000, Average Loss:0.3115120581433177, Current Loss:0.28235021233558655
[INFO] 2022-11-07 16:23:09,934 - Epoch:1, Batch:5500, Average Loss:0.304596323505044, Current Loss:0.025139957666397095
[INFO] 2022-11-07 16:24:45,097 - Epoch:1, Batch:6000, Average Loss:0.2980738839817544, Current Loss:0.11719568073749542
[INFO] 2022-11-07 16:26:22,312 - Epoch:1, Batch:6500, Average Loss:0.2925063398056305, Current Loss:0.3079760670661926
[INFO] 2022-11-07 16:27:59,411 - Epoch:1, Batch:7000, Average Loss:0.28728637005814484, Current Loss:0.2713897228240967
[INFO] 2022-11-07 16:29:37,606 - Epoch:1, Batch:7500, Average Loss:0.2821338996469975, Current Loss:0.2399308979511261
[INFO] 2022-11-07 16:31:14,365 - Epoch:1, Batch:8000, Average Loss:0.2779113381477073, Current Loss:0.10282891988754272
[INFO] 2022-11-07 16:32:52,190 - Epoch:1, Batch:8500, Average Loss:0.2740288000571377, Current Loss:0.12344863265752792
[INFO] 2022-11-07 16:34:31,152 - Epoch:1, Batch:9000, Average Loss:0.27046106512513424, Current Loss:0.3445623815059662
[INFO] 2022-11-07 16:36:10,455 - Epoch:1, Batch:9500, Average Loss:0.2670508198110681, Current Loss:0.20840977132320404
[INFO] 2022-11-07 16:37:49,081 - Epoch:1, Batch:10000, Average Loss:0.2643566612675786, Current Loss:0.29802244901657104
[INFO] 2022-11-07 16:39:26,176 - Epoch:1, Batch:10500, Average Loss:0.2620429748176109, Current Loss:0.2622489333152771
[INFO] 2022-11-07 16:41:04,156 - Epoch:1, Batch:11000, Average Loss:0.26003341859782286, Current Loss:0.2460557520389557
[INFO] 2022-11-07 16:42:43,338 - Epoch:1, Batch:11500, Average Loss:0.2576890822065913, Current Loss:0.058135248720645905
[INFO] 2022-11-07 16:44:22,198 - Epoch:1, Batch:12000, Average Loss:0.25546683741174636, Current Loss:0.10961578041315079
[INFO] 2022-11-07 16:45:59,433 - Epoch:1, Batch:12500, Average Loss:0.25342824914216994, Current Loss:0.16429975628852844
[INFO] 2022-11-07 16:47:36,482 - Epoch:1, Batch:13000, Average Loss:0.2510523267279451, Current Loss:0.12930655479431152
[INFO] 2022-11-07 16:49:11,700 - Epoch:1, Batch:13500, Average Loss:0.24914612285958396, Current Loss:0.21859833598136902
[INFO] 2022-11-07 16:50:46,505 - Epoch:1, Batch:14000, Average Loss:0.24734374524014335, Current Loss:0.05176091939210892
[INFO] 2022-11-07 16:52:22,800 - Epoch:1, Batch:14500, Average Loss:0.24575234666518098, Current Loss:0.18498201668262482
[INFO] 2022-11-07 16:53:57,787 - Epoch:1, Batch:15000, Average Loss:0.2441984373594324, Current Loss:0.13626721501350403
[INFO] 2022-11-07 16:55:32,798 - Epoch:1, Batch:15500, Average Loss:0.24276204116113725, Current Loss:0.2492089420557022
[INFO] 2022-11-07 16:57:08,741 - Epoch:1, Batch:16000, Average Loss:0.24125208476837726, Current Loss:0.06405695527791977
[INFO] 2022-11-07 16:58:44,053 - Epoch:1, Batch:16500, Average Loss:0.2397757249022975, Current Loss:0.20567986369132996
[INFO] 2022-11-07 17:00:19,342 - Epoch:1, Batch:17000, Average Loss:0.23825055633266182, Current Loss:0.08062420040369034
[INFO] 2022-11-07 17:01:55,282 - Epoch:1, Batch:17500, Average Loss:0.23704250659729753, Current Loss:0.2614797055721283
[INFO] 2022-11-07 17:03:30,563 - Epoch:1, Batch:18000, Average Loss:0.23576039857831266, Current Loss:0.2215609848499298
[INFO] 2022-11-07 17:05:06,202 - Epoch:1, Batch:18500, Average Loss:0.23438248279731017, Current Loss:0.036811791360378265
[INFO] 2022-11-07 17:06:42,378 - Epoch:1, Batch:19000, Average Loss:0.23341053327604344, Current Loss:0.06030065566301346
[INFO] 2022-11-07 17:08:18,478 - Epoch:1, Batch:19500, Average Loss:0.2319884407684589, Current Loss:0.12986184656620026
[INFO] 2022-11-07 17:09:53,868 - Epoch:1, Batch:20000, Average Loss:0.23084622551091016, Current Loss:0.378256231546402
[INFO] 2022-11-07 17:10:45,025 - Evaluation --- MRR :{1: 0.2765818656229615, 2: 0.3259621656881931, 3: 0.34353120243531254, 5: 0.3583061535116333, 10: 0.3697629919547729, 15: 0.37333500593774493, 50: 0.3781075449768384, 100: 0.3789332090061075}, HIT:{1: 0.2765818656229615, 2: 0.37534246575342467, 3: 0.4280495759947815, 5: 0.49328114807566864, 10: 0.5788649706457926, 15: 0.62426614481409, 50: 0.7454664057403784, 100: 0.8033920417482061}
[INFO] 2022-11-07 17:10:45,078 - Evaluation --- Max MRR:0, Current MRR:{1: 0.2765818656229615, 2: 0.3259621656881931, 3: 0.34353120243531254, 5: 0.3583061535116333, 10: 0.3697629919547729, 15: 0.37333500593774493, 50: 0.3781075449768384, 100: 0.3789332090061075}, Current HIT:{1: 0.2765818656229615, 2: 0.37534246575342467, 3: 0.4280495759947815, 5: 0.49328114807566864, 10: 0.5788649706457926, 15: 0.62426614481409, 50: 0.7454664057403784, 100: 0.8033920417482061}
[INFO] 2022-11-07 17:12:29,041 - Epoch:1, Batch:20500, Average Loss:0.22947213029679728, Current Loss:0.11499638110399246
[INFO] 2022-11-07 17:14:02,365 - Epoch:1, Batch:21000, Average Loss:0.22795613538438367, Current Loss:0.047252170741558075
[INFO] 2022-11-07 17:15:34,638 - Epoch:1, Batch:21500, Average Loss:0.22646958043651524, Current Loss:0.39374834299087524
[INFO] 2022-11-07 17:17:04,916 - Epoch:1, Batch:22000, Average Loss:0.22519461221688172, Current Loss:0.42596548795700073
[INFO] 2022-11-07 17:18:36,912 - Epoch:1, Batch:22500, Average Loss:0.22375396890706487, Current Loss:0.22390615940093994
[INFO] 2022-11-07 17:20:08,665 - Epoch:1, Batch:23000, Average Loss:0.22264188829809428, Current Loss:0.22992530465126038
[INFO] 2022-11-07 17:21:40,176 - Epoch:1, Batch:23500, Average Loss:0.22153388637716465, Current Loss:0.07702784985303879
[INFO] 2022-11-07 17:23:11,621 - Epoch:1, Batch:24000, Average Loss:0.22021268336474895, Current Loss:0.04093682020902634
[INFO] 2022-11-07 17:24:44,413 - Epoch:1, Batch:24500, Average Loss:0.2189023893204879, Current Loss:0.1477680504322052
[INFO] 2022-11-07 17:26:16,506 - Epoch:1, Batch:25000, Average Loss:0.21782892569303514, Current Loss:0.44310271739959717
[INFO] 2022-11-07 17:27:48,176 - Epoch:1, Batch:25500, Average Loss:0.2167816022035538, Current Loss:0.21620795130729675
[INFO] 2022-11-07 17:29:18,899 - Epoch:1, Batch:26000, Average Loss:0.21581684130458878, Current Loss:0.04854011535644531
[INFO] 2022-11-07 17:30:49,536 - Epoch:1, Batch:26500, Average Loss:0.21484704234633806, Current Loss:0.23348058760166168
[INFO] 2022-11-07 17:32:21,056 - Epoch:1, Batch:27000, Average Loss:0.21403368690278796, Current Loss:0.19431015849113464
[INFO] 2022-11-07 17:33:53,244 - Epoch:1, Batch:27500, Average Loss:0.21311802131208507, Current Loss:0.18718484044075012
[INFO] 2022-11-07 17:35:25,954 - Epoch:1, Batch:28000, Average Loss:0.2121252124099327, Current Loss:0.18971484899520874
[INFO] 2022-11-07 17:36:56,618 - Epoch:1, Batch:28500, Average Loss:0.21104874432086945, Current Loss:0.06577970087528229
[INFO] 2022-11-07 17:38:28,234 - Epoch:1, Batch:29000, Average Loss:0.21009703228905283, Current Loss:0.012356415390968323
[INFO] 2022-11-07 17:40:00,110 - Epoch:1, Batch:29500, Average Loss:0.20934949625068802, Current Loss:0.378090500831604
[INFO] 2022-11-07 17:41:31,274 - Epoch:1, Batch:30000, Average Loss:0.2084560261550049, Current Loss:0.0570620521903038
[INFO] 2022-11-07 17:43:02,532 - Epoch:1, Batch:30500, Average Loss:0.20765605263631853, Current Loss:0.0960390567779541
[INFO] 2022-11-07 17:44:34,050 - Epoch:1, Batch:31000, Average Loss:0.2068776677750772, Current Loss:0.1399683952331543
[INFO] 2022-11-07 17:46:05,623 - Epoch:1, Batch:31500, Average Loss:0.20615874485837088, Current Loss:0.16065774857997894
[INFO] 2022-11-07 17:47:36,964 - Epoch:1, Batch:32000, Average Loss:0.20546164538664743, Current Loss:0.20786446332931519
[INFO] 2022-11-07 17:49:07,664 - Epoch:1, Batch:32500, Average Loss:0.20472826992915227, Current Loss:0.10479270666837692
[INFO] 2022-11-07 17:50:38,948 - Epoch:1, Batch:33000, Average Loss:0.20404394566403194, Current Loss:0.001434922218322754
[INFO] 2022-11-07 17:52:10,882 - Epoch:1, Batch:33500, Average Loss:0.2032689238855643, Current Loss:0.13102272152900696
[INFO] 2022-11-07 17:53:41,097 - Epoch:1, Batch:34000, Average Loss:0.20252042428973843, Current Loss:0.20517395436763763
[INFO] 2022-11-07 17:55:11,988 - Epoch:1, Batch:34500, Average Loss:0.20170854905614818, Current Loss:0.015222020447254181
[INFO] 2022-11-07 17:56:44,494 - Epoch:2, Batch:203, Average Loss:0.16121395185516385, Current Loss:0.23962196707725525
[INFO] 2022-11-07 17:58:20,145 - Epoch:2, Batch:703, Average Loss:0.16038027921874357, Current Loss:0.23702532052993774
[INFO] 2022-11-07 17:59:53,991 - Epoch:2, Batch:1203, Average Loss:0.16319278833872064, Current Loss:0.11713472753763199
[INFO] 2022-11-07 18:01:29,538 - Epoch:2, Batch:1703, Average Loss:0.1633534139909257, Current Loss:0.2117617130279541
[INFO] 2022-11-07 18:03:04,895 - Epoch:2, Batch:2203, Average Loss:0.16254919585765518, Current Loss:0.13213180005550385
[INFO] 2022-11-07 18:04:40,308 - Epoch:2, Batch:2703, Average Loss:0.16147589389974878, Current Loss:0.2952228784561157
[INFO] 2022-11-07 18:06:15,467 - Epoch:2, Batch:3203, Average Loss:0.16105193483561528, Current Loss:0.11261291801929474
[INFO] 2022-11-07 18:07:51,850 - Epoch:2, Batch:3703, Average Loss:0.16134322134869955, Current Loss:0.04657231271266937
[INFO] 2022-11-07 18:09:27,838 - Epoch:2, Batch:4203, Average Loss:0.16177081691986206, Current Loss:0.36159706115722656
[INFO] 2022-11-07 18:11:04,120 - Epoch:2, Batch:4703, Average Loss:0.1613476896239118, Current Loss:0.29178380966186523
[INFO] 2022-11-07 18:12:39,617 - Epoch:2, Batch:5203, Average Loss:0.16116020264715822, Current Loss:0.10283664613962173
[INFO] 2022-11-07 18:13:30,761 - Evaluation --- MRR :{1: 0.2713633398564905, 2: 0.3193737769080235, 3: 0.3380734942378783, 5: 0.353592085235921, 10: 0.36500295095207014, 15: 0.3691174882955691, 50: 0.3739876544814183, 100: 0.374856718290322}, HIT:{1: 0.2713633398564905, 2: 0.36738421395955645, 3: 0.4234833659491194, 5: 0.4914546640574038, 10: 0.5763861709067188, 15: 0.628310502283105, 50: 0.7557729941291585, 100: 0.8151337247227658}
[INFO] 2022-11-07 18:13:30,799 - Evaluation --- Max MRR:0.3697629919547729, Current MRR:{1: 0.2713633398564905, 2: 0.3193737769080235, 3: 0.3380734942378783, 5: 0.353592085235921, 10: 0.36500295095207014, 15: 0.3691174882955691, 50: 0.3739876544814183, 100: 0.374856718290322}, Current HIT:{1: 0.2713633398564905, 2: 0.36738421395955645, 3: 0.4234833659491194, 5: 0.4914546640574038, 10: 0.5763861709067188, 15: 0.628310502283105, 50: 0.7557729941291585, 100: 0.8151337247227658}
[INFO] 2022-11-07 18:15:03,628 - Epoch:2, Batch:5703, Average Loss:0.15966998505896485, Current Loss:0.02667015790939331
[INFO] 2022-11-07 18:16:35,713 - Epoch:2, Batch:6203, Average Loss:0.15783159211506176, Current Loss:0.04575876146554947
[INFO] 2022-11-07 18:18:07,181 - Epoch:2, Batch:6703, Average Loss:0.15639065141026412, Current Loss:0.24793869256973267
[INFO] 2022-11-07 18:19:39,079 - Epoch:2, Batch:7203, Average Loss:0.15520493900210727, Current Loss:0.03692537546157837
[INFO] 2022-11-07 18:21:10,943 - Epoch:2, Batch:7703, Average Loss:0.15459651960388618, Current Loss:0.05350479483604431
[INFO] 2022-11-07 18:22:43,790 - Epoch:2, Batch:8203, Average Loss:0.1538404072386803, Current Loss:0.17571523785591125
[INFO] 2022-11-07 18:24:16,456 - Epoch:2, Batch:8703, Average Loss:0.15258550798959408, Current Loss:0.0824950635433197
[INFO] 2022-11-07 18:25:47,722 - Epoch:2, Batch:9203, Average Loss:0.1515622081472461, Current Loss:0.22416484355926514
[INFO] 2022-11-07 18:27:19,943 - Epoch:2, Batch:9703, Average Loss:0.1508670833472811, Current Loss:0.10088536888360977
[INFO] 2022-11-07 18:28:51,715 - Epoch:2, Batch:10203, Average Loss:0.15024016295871606, Current Loss:0.11304601281881332
[INFO] 2022-11-07 18:30:23,397 - Epoch:2, Batch:10703, Average Loss:0.14985241706344798, Current Loss:0.019422411918640137
[INFO] 2022-11-07 18:31:52,202 - Epoch:2, Batch:11203, Average Loss:0.1495362041646281, Current Loss:0.14811187982559204
[INFO] 2022-11-07 18:33:23,860 - Epoch:2, Batch:11703, Average Loss:0.14946998566921313, Current Loss:0.22859156131744385
[INFO] 2022-11-07 18:34:54,506 - Epoch:2, Batch:12203, Average Loss:0.14906442880943097, Current Loss:0.11524121463298798
[INFO] 2022-11-07 18:36:26,420 - Epoch:2, Batch:12703, Average Loss:0.1482833024220824, Current Loss:0.18497027456760406
[INFO] 2022-11-07 18:37:57,220 - Epoch:2, Batch:13203, Average Loss:0.14808631885356907, Current Loss:0.21676480770111084
[INFO] 2022-11-07 18:39:28,512 - Epoch:2, Batch:13703, Average Loss:0.14754391932688882, Current Loss:0.186459481716156
[INFO] 2022-11-07 18:40:59,719 - Epoch:2, Batch:14203, Average Loss:0.14729836792444115, Current Loss:0.16553691029548645
[INFO] 2022-11-07 18:42:31,396 - Epoch:2, Batch:14703, Average Loss:0.14669497941751702, Current Loss:0.08445193618535995
[INFO] 2022-11-07 18:44:02,246 - Epoch:2, Batch:15203, Average Loss:0.14623149212405437, Current Loss:0.04444222152233124
[INFO] 2022-11-07 18:45:33,632 - Epoch:2, Batch:15703, Average Loss:0.14591659067977594, Current Loss:0.07005708664655685
[INFO] 2022-11-07 18:47:05,034 - Epoch:2, Batch:16203, Average Loss:0.1459874405409461, Current Loss:0.1733570694923401
[INFO] 2022-11-07 18:48:36,636 - Epoch:2, Batch:16703, Average Loss:0.1459107291155687, Current Loss:0.061798594892024994
[INFO] 2022-11-07 18:50:07,228 - Epoch:2, Batch:17203, Average Loss:0.1454816073900786, Current Loss:0.041848428547382355
[INFO] 2022-11-07 18:51:38,829 - Epoch:2, Batch:17703, Average Loss:0.14537689283415267, Current Loss:0.17414572834968567
[INFO] 2022-11-07 18:53:10,415 - Epoch:2, Batch:18203, Average Loss:0.14491399072570302, Current Loss:0.19569973647594452
[INFO] 2022-11-07 18:54:42,868 - Epoch:2, Batch:18703, Average Loss:0.14460244685505466, Current Loss:0.18968728184700012
[INFO] 2022-11-07 18:56:15,595 - Epoch:2, Batch:19203, Average Loss:0.14453214442701084, Current Loss:0.2491869330406189
[INFO] 2022-11-07 18:57:47,463 - Epoch:2, Batch:19703, Average Loss:0.14443823724148666, Current Loss:0.1022421345114708
[INFO] 2022-11-07 18:59:19,184 - Epoch:2, Batch:20203, Average Loss:0.1442342935441532, Current Loss:0.1806045025587082
[INFO] 2022-11-07 19:00:52,560 - Epoch:2, Batch:20703, Average Loss:0.1439272615852917, Current Loss:0.02867615967988968
[INFO] 2022-11-07 19:02:24,796 - Epoch:2, Batch:21203, Average Loss:0.14370731196639414, Current Loss:0.0064821913838386536
[INFO] 2022-11-07 19:03:56,291 - Epoch:2, Batch:21703, Average Loss:0.14352894823053974, Current Loss:0.2312968373298645
[INFO] 2022-11-07 19:05:27,131 - Epoch:2, Batch:22203, Average Loss:0.14334747511146037, Current Loss:0.039896272122859955
[INFO] 2022-11-07 19:06:59,550 - Epoch:2, Batch:22703, Average Loss:0.14327726680943761, Current Loss:0.08082518726587296
[INFO] 2022-11-07 19:08:30,479 - Epoch:2, Batch:23203, Average Loss:0.1430945998461592, Current Loss:0.18571627140045166
[INFO] 2022-11-07 19:10:02,132 - Epoch:2, Batch:23703, Average Loss:0.14290769917643917, Current Loss:0.12697046995162964
[INFO] 2022-11-07 19:11:32,312 - Epoch:2, Batch:24203, Average Loss:0.1426356882940505, Current Loss:0.20759618282318115
[INFO] 2022-11-07 19:13:03,614 - Epoch:2, Batch:24703, Average Loss:0.1425281318373363, Current Loss:0.1465921401977539
[INFO] 2022-11-07 19:14:34,982 - Epoch:2, Batch:25203, Average Loss:0.14227842653895761, Current Loss:0.18505071103572845
[INFO] 2022-11-07 19:15:25,974 - Evaluation --- MRR :{1: 0.2879321591650359, 2: 0.3385518590998043, 3: 0.3594259621656891, 5: 0.37493150684931575, 10: 0.38642251421116514, 15: 0.38987888823505273, 50: 0.3945590115995192, 100: 0.395354101032503}, HIT:{1: 0.2879321591650359, 2: 0.38917155903457273, 3: 0.4517938682322244, 5: 0.5197651663405088, 10: 0.6061317677756034, 15: 0.6500978473581214, 50: 0.7703848662752772, 100: 0.8251793868232224}
[INFO] 2022-11-07 19:15:25,975 - Evaluation --- Max MRR:0.3697629919547729, Current MRR:{1: 0.2879321591650359, 2: 0.3385518590998043, 3: 0.3594259621656891, 5: 0.37493150684931575, 10: 0.38642251421116514, 15: 0.38987888823505273, 50: 0.3945590115995192, 100: 0.395354101032503}, Current HIT:{1: 0.2879321591650359, 2: 0.38917155903457273, 3: 0.4517938682322244, 5: 0.5197651663405088, 10: 0.6061317677756034, 15: 0.6500978473581214, 50: 0.7703848662752772, 100: 0.8251793868232224}
[INFO] 2022-11-07 19:17:10,167 - Epoch:2, Batch:25703, Average Loss:0.1419535865618418, Current Loss:0.24188044667243958
[INFO] 2022-11-07 19:18:41,840 - Epoch:2, Batch:26203, Average Loss:0.14164702522569506, Current Loss:0.07245822995901108
[INFO] 2022-11-07 19:20:13,072 - Epoch:2, Batch:26703, Average Loss:0.14146767189174547, Current Loss:0.043874844908714294
[INFO] 2022-11-07 19:21:45,115 - Epoch:2, Batch:27203, Average Loss:0.14131552660927127, Current Loss:0.01783892512321472
[INFO] 2022-11-07 19:23:16,317 - Epoch:2, Batch:27703, Average Loss:0.1412010590589503, Current Loss:0.29909998178482056
[INFO] 2022-11-07 19:24:48,255 - Epoch:2, Batch:28203, Average Loss:0.140991097341705, Current Loss:0.07606558501720428
[INFO] 2022-11-07 19:26:19,828 - Epoch:2, Batch:28703, Average Loss:0.14086719947684972, Current Loss:0.12205248326063156
[INFO] 2022-11-07 19:27:52,179 - Epoch:2, Batch:29203, Average Loss:0.14074097212849343, Current Loss:0.04406237602233887
[INFO] 2022-11-07 19:29:23,249 - Epoch:2, Batch:29703, Average Loss:0.14061052889731485, Current Loss:0.12150302529335022
[INFO] 2022-11-07 19:30:55,676 - Epoch:2, Batch:30203, Average Loss:0.14038864588814848, Current Loss:0.03452935069799423
[INFO] 2022-11-07 19:32:27,248 - Epoch:2, Batch:30703, Average Loss:0.1402211603741477, Current Loss:0.0766250491142273
[INFO] 2022-11-07 19:33:58,043 - Epoch:2, Batch:31203, Average Loss:0.14015043132092844, Current Loss:0.06113738566637039
[INFO] 2022-11-07 19:35:29,449 - Epoch:2, Batch:31703, Average Loss:0.1399719888886168, Current Loss:0.06241719424724579
[INFO] 2022-11-07 19:37:01,353 - Epoch:2, Batch:32203, Average Loss:0.13988548056213387, Current Loss:0.11310233920812607
[INFO] 2022-11-07 19:38:32,656 - Epoch:2, Batch:32703, Average Loss:0.13972183483828282, Current Loss:0.14684566855430603
[INFO] 2022-11-07 19:40:04,987 - Epoch:2, Batch:33203, Average Loss:0.1396513106054873, Current Loss:0.24967417120933533
[INFO] 2022-11-07 19:41:37,161 - Epoch:2, Batch:33703, Average Loss:0.1395594417990055, Current Loss:0.0780019462108612
[INFO] 2022-11-07 19:43:10,581 - Epoch:2, Batch:34203, Average Loss:0.13948206846368552, Current Loss:0.10660163313150406
[INFO] 2022-11-07 19:44:43,057 - Epoch:2, Batch:34703, Average Loss:0.13924816606551657, Current Loss:0.4812832176685333
[INFO] 2022-11-07 19:46:19,898 - Epoch:3, Batch:406, Average Loss:0.1393843847762775, Current Loss:0.22572928667068481
[INFO] 2022-11-07 19:47:58,801 - Epoch:3, Batch:906, Average Loss:0.14317864101487016, Current Loss:0.14083418250083923
[INFO] 2022-11-07 19:49:35,763 - Epoch:3, Batch:1406, Average Loss:0.13878095149993896, Current Loss:0.13008059561252594
[INFO] 2022-11-07 19:51:12,942 - Epoch:3, Batch:1906, Average Loss:0.1380085849436733, Current Loss:0.1628645360469818
[INFO] 2022-11-07 19:52:50,411 - Epoch:3, Batch:2406, Average Loss:0.13835430725269385, Current Loss:0.09735479205846786
[INFO] 2022-11-07 19:54:27,870 - Epoch:3, Batch:2906, Average Loss:0.13869688166106722, Current Loss:0.06385362148284912
[INFO] 2022-11-07 19:56:06,038 - Epoch:3, Batch:3406, Average Loss:0.13930555222161153, Current Loss:0.27785784006118774
[INFO] 2022-11-07 19:57:44,283 - Epoch:3, Batch:3906, Average Loss:0.13857056337079207, Current Loss:0.20978273451328278
[INFO] 2022-11-07 19:59:21,698 - Epoch:3, Batch:4406, Average Loss:0.13798875381973078, Current Loss:0.29383963346481323
[INFO] 2022-11-07 20:00:59,542 - Epoch:3, Batch:4906, Average Loss:0.13873057682150683, Current Loss:0.1400696188211441
[INFO] 2022-11-07 20:02:36,748 - Epoch:3, Batch:5406, Average Loss:0.13805256325433177, Current Loss:0.1360521912574768
[INFO] 2022-11-07 20:04:13,915 - Epoch:3, Batch:5906, Average Loss:0.13808902318356323, Current Loss:0.06515183299779892
[INFO] 2022-11-07 20:05:52,196 - Epoch:3, Batch:6406, Average Loss:0.13828219151542478, Current Loss:0.12346097081899643
[INFO] 2022-11-07 20:07:30,444 - Epoch:3, Batch:6906, Average Loss:0.13839028466491812, Current Loss:0.1964300572872162
[INFO] 2022-11-07 20:09:09,038 - Epoch:3, Batch:7406, Average Loss:0.13777902751835075, Current Loss:0.22303512692451477
[INFO] 2022-11-07 20:10:45,559 - Epoch:3, Batch:7906, Average Loss:0.1374071406154822, Current Loss:0.17999115586280823
[INFO] 2022-11-07 20:12:23,921 - Epoch:3, Batch:8406, Average Loss:0.1374180284219074, Current Loss:0.03279499709606171
[INFO] 2022-11-07 20:14:01,515 - Epoch:3, Batch:8906, Average Loss:0.13713516622979185, Current Loss:0.11184272170066833
[INFO] 2022-11-07 20:15:38,051 - Epoch:3, Batch:9406, Average Loss:0.13676060089738906, Current Loss:0.008304722607135773
[INFO] 2022-11-07 20:17:15,883 - Epoch:3, Batch:9906, Average Loss:0.13668317460809817, Current Loss:0.10684312880039215
[INFO] 2022-11-07 20:18:53,370 - Epoch:3, Batch:10406, Average Loss:0.13610457269610543, Current Loss:0.18389877676963806
[INFO] 2022-11-07 20:19:44,457 - Evaluation --- MRR :{1: 0.2669275929549902, 2: 0.3148075668623614, 3: 0.3345075016307891, 5: 0.34993476842791865, 10: 0.36141402375257536, 15: 0.3651671547268406, 50: 0.36992938039826756, 100: 0.3707386680485689}, HIT:{1: 0.2669275929549902, 2: 0.36268754076973253, 3: 0.4217873450750163, 5: 0.48910632746249183, 10: 0.5744292237442923, 15: 0.6221787345075016, 50: 0.7442922374429224, 100: 0.8003913894324853}
[INFO] 2022-11-07 20:19:44,458 - Evaluation --- Max MRR:0.38642251421116514, Current MRR:{1: 0.2669275929549902, 2: 0.3148075668623614, 3: 0.3345075016307891, 5: 0.34993476842791865, 10: 0.36141402375257536, 15: 0.3651671547268406, 50: 0.36992938039826756, 100: 0.3707386680485689}, Current HIT:{1: 0.2669275929549902, 2: 0.36268754076973253, 3: 0.4217873450750163, 5: 0.48910632746249183, 10: 0.5744292237442923, 15: 0.6221787345075016, 50: 0.7442922374429224, 100: 0.8003913894324853}
[INFO] 2022-11-07 20:21:19,394 - Epoch:3, Batch:10906, Average Loss:0.1352238319909848, Current Loss:0.05671026557683945
[INFO] 2022-11-07 20:22:52,836 - Epoch:3, Batch:11406, Average Loss:0.13436016793585379, Current Loss:0.4417499899864197
[INFO] 2022-11-07 20:24:26,267 - Epoch:3, Batch:11906, Average Loss:0.13375457206278835, Current Loss:0.010258205235004425
[INFO] 2022-11-07 20:25:59,624 - Epoch:3, Batch:12406, Average Loss:0.13290272746610485, Current Loss:0.013339973986148834
[INFO] 2022-11-07 20:27:33,535 - Epoch:3, Batch:12906, Average Loss:0.13218284484449883, Current Loss:0.006467953324317932
[INFO] 2022-11-07 20:29:06,859 - Epoch:3, Batch:13406, Average Loss:0.13151963421160404, Current Loss:0.1584128439426422
[INFO] 2022-11-07 20:30:39,602 - Epoch:3, Batch:13906, Average Loss:0.13098332648873157, Current Loss:0.06234147399663925
[INFO] 2022-11-07 20:32:15,375 - Epoch:3, Batch:14406, Average Loss:0.13034871031040038, Current Loss:0.043558672070503235
[INFO] 2022-11-07 20:33:50,777 - Epoch:3, Batch:14906, Average Loss:0.12990844284663997, Current Loss:0.1851392388343811
[INFO] 2022-11-07 20:35:36,023 - Epoch:3, Batch:15406, Average Loss:0.12943957673970188, Current Loss:0.0586337074637413
[INFO] 2022-11-07 20:37:09,805 - Epoch:3, Batch:15906, Average Loss:0.12883555740548966, Current Loss:0.1908392757177353
[INFO] 2022-11-07 20:38:43,137 - Epoch:3, Batch:16406, Average Loss:0.12820658025195666, Current Loss:0.02047426998615265
[INFO] 2022-11-07 20:40:24,774 - Epoch:3, Batch:16906, Average Loss:0.12771726598374578, Current Loss:0.1154739111661911
[INFO] 2022-11-07 20:42:35,540 - Epoch:3, Batch:17406, Average Loss:0.1274296727669687, Current Loss:0.18623292446136475
[INFO] 2022-11-07 20:44:46,564 - Epoch:3, Batch:17906, Average Loss:0.1270148138342244, Current Loss:0.0013848692178726196
[INFO] 2022-11-07 20:46:57,585 - Epoch:3, Batch:18406, Average Loss:0.12677537788753662, Current Loss:0.020232215523719788
[INFO] 2022-11-07 20:49:08,957 - Epoch:3, Batch:18906, Average Loss:0.1262790956388141, Current Loss:0.18157103657722473
[INFO] 2022-11-07 20:51:17,999 - Epoch:3, Batch:19406, Average Loss:0.12595372613760156, Current Loss:0.11055169254541397
[INFO] 2022-11-07 20:53:28,610 - Epoch:3, Batch:19906, Average Loss:0.12560039806815712, Current Loss:0.03641912341117859
[INFO] 2022-11-07 20:55:40,282 - Epoch:3, Batch:20406, Average Loss:0.1251463105552111, Current Loss:0.182957261800766
[INFO] 2022-11-07 20:57:50,891 - Epoch:3, Batch:20906, Average Loss:0.12485648855947598, Current Loss:0.2061762809753418
[INFO] 2022-11-07 21:00:01,750 - Epoch:3, Batch:21406, Average Loss:0.12441885689403825, Current Loss:0.027302905917167664
[INFO] 2022-11-07 21:02:13,186 - Epoch:3, Batch:21906, Average Loss:0.12418156823553712, Current Loss:0.10179179906845093
[INFO] 2022-11-07 21:03:59,735 - Epoch:3, Batch:22406, Average Loss:0.1239114149272346, Current Loss:0.02233080565929413
[INFO] 2022-11-07 21:06:00,124 - Epoch:3, Batch:22906, Average Loss:0.12364119237506274, Current Loss:0.07173651456832886
[INFO] 2022-11-07 21:08:11,052 - Epoch:3, Batch:23406, Average Loss:0.1233834946225833, Current Loss:0.07286781072616577
[INFO] 2022-11-07 21:10:24,357 - Epoch:3, Batch:23906, Average Loss:0.12318264649513824, Current Loss:0.15832658112049103
[INFO] 2022-11-07 21:12:35,872 - Epoch:3, Batch:24406, Average Loss:0.12300635759212644, Current Loss:0.08272914588451385
[INFO] 2022-11-07 21:14:47,902 - Epoch:3, Batch:24906, Average Loss:0.12278462411209225, Current Loss:0.07078396528959274
[INFO] 2022-11-07 21:16:57,844 - Epoch:3, Batch:25406, Average Loss:0.12254631456794451, Current Loss:0.04813717305660248
[INFO] 2022-11-07 21:19:09,439 - Epoch:3, Batch:25906, Average Loss:0.12228224571775002, Current Loss:0.06803946942090988
[INFO] 2022-11-07 21:21:20,384 - Epoch:3, Batch:26406, Average Loss:0.12210931099535371, Current Loss:0.24831034243106842
[INFO] 2022-11-07 21:23:19,269 - Epoch:3, Batch:26906, Average Loss:0.12190615759407473, Current Loss:0.002713620662689209
[INFO] 2022-11-07 21:25:29,781 - Epoch:3, Batch:27406, Average Loss:0.12161903905101235, Current Loss:0.028549373149871826
[INFO] 2022-11-07 21:27:40,750 - Epoch:3, Batch:27906, Average Loss:0.12136145879889033, Current Loss:0.07410359382629395
[INFO] 2022-11-07 21:29:50,950 - Epoch:3, Batch:28406, Average Loss:0.12122198135066745, Current Loss:0.12432596832513809
[INFO] 2022-11-07 21:32:00,557 - Epoch:3, Batch:28906, Average Loss:0.12101183060368749, Current Loss:0.12208204716444016
[INFO] 2022-11-07 21:34:12,887 - Epoch:3, Batch:29406, Average Loss:0.12085743961494845, Current Loss:0.016030244529247284
[INFO] 2022-11-07 21:36:22,989 - Epoch:3, Batch:29906, Average Loss:0.12061030116354009, Current Loss:0.04130244255065918
[INFO] 2022-11-07 21:38:34,552 - Epoch:3, Batch:30406, Average Loss:0.12037754967531342, Current Loss:0.079802006483078
[INFO] 2022-11-07 21:39:47,697 - Evaluation --- MRR :{1: 0.2643183300717547, 2: 0.31258969341161125, 3: 0.3318112633181127, 5: 0.34738203957382036, 10: 0.35951273051077354, 15: 0.3632475062807738, 50: 0.3677315541988532, 100: 0.36868901192009923}, HIT:{1: 0.2643183300717547, 2: 0.36086105675146773, 3: 0.41852576647097195, 5: 0.4866275277234181, 10: 0.5779517286366601, 15: 0.6253098499673843, 50: 0.7403783431180692, 100: 0.806392694063927}
[INFO] 2022-11-07 21:39:47,698 - Evaluation --- Max MRR:0.38642251421116514, Current MRR:{1: 0.2643183300717547, 2: 0.31258969341161125, 3: 0.3318112633181127, 5: 0.34738203957382036, 10: 0.35951273051077354, 15: 0.3632475062807738, 50: 0.3677315541988532, 100: 0.36868901192009923}, Current HIT:{1: 0.2643183300717547, 2: 0.36086105675146773, 3: 0.41852576647097195, 5: 0.4866275277234181, 10: 0.5779517286366601, 15: 0.6253098499673843, 50: 0.7403783431180692, 100: 0.806392694063927}
[INFO] 2022-11-07 21:41:59,601 - Epoch:3, Batch:30906, Average Loss:0.12030483476033159, Current Loss:0.1163463443517685
[INFO] 2022-11-07 21:44:11,310 - Epoch:3, Batch:31406, Average Loss:0.12025419968760812, Current Loss:0.2927466630935669
[INFO] 2022-11-07 21:46:22,843 - Epoch:3, Batch:31906, Average Loss:0.12009254381147469, Current Loss:0.09942170232534409
[INFO] 2022-11-07 21:48:34,791 - Epoch:3, Batch:32406, Average Loss:0.11995694286546972, Current Loss:0.1491493433713913
[INFO] 2022-11-07 21:50:45,012 - Epoch:3, Batch:32906, Average Loss:0.11979304007211804, Current Loss:0.1981096863746643
[INFO] 2022-11-07 21:52:57,479 - Epoch:3, Batch:33406, Average Loss:0.11961312819811346, Current Loss:0.020097434520721436
[INFO] 2022-11-07 21:55:07,710 - Epoch:3, Batch:33906, Average Loss:0.11954338213403914, Current Loss:0.01046125590801239
[INFO] 2022-11-07 21:57:18,606 - Epoch:3, Batch:34406, Average Loss:0.11934615789978634, Current Loss:0.027090080082416534
[INFO] 2022-11-07 21:58:59,704 - Start testing...
[INFO] 2022-11-07 22:01:29,073 - Evaluation --- MRR :{1: 0.20873384683939142, 2: 0.24902921891909097, 3: 0.2642222080760523, 5: 0.2780423112016462, 10: 0.2894832807398857, 15: 0.2932218406500644, 50: 0.2983327098970568, 100: 0.2994003810342578}, HIT:{1: 0.20873384683939142, 2: 0.2893245909987905, 3: 0.3349035584696671, 5: 0.39544210325291235, 10: 0.4805525494939207, 15: 0.5275956458081354, 50: 0.6621045260678592, 100: 0.7365204659749188}
